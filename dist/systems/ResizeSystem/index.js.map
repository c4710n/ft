{"version":3,"sources":["../../../src/systems/ResizeSystem/index.js"],"names":["System","Device","events","delay","ResizeSystem","cssSize","clone","width","height","$cachedWidth","$cachedHeight","$cachedHasInputFocused","$emitLock","resize","emit","hasInputFocused","document","activeElement","tagName","hasFocus","isInputSwitchToBlured","delayEmitResizeEvent","emitResizeEvent","isIOS","window","scroll"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,MAAP,MAAmB,WAAnB;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,OAAOC,MAAP,MAAmB,cAAnB;AACA,SAASC,KAAT,QAAsB,YAAtB;;IAEMC,Y;;;;;AACJ,0BAAc;AAAA;;AAAA;;AACZ,8BAAM,QAAN;;AAEA,gCAA0BH,MAAM,CAACI,OAAP,CAAeC,KAAf,EAA1B;AAAA,QAAQC,KAAR,yBAAQA,KAAR;AAAA,QAAeC,MAAf,yBAAeA,MAAf;;AACA,UAAKC,YAAL,GAAoBF,KAApB;AACA,UAAKG,aAAL,GAAqBF,MAArB;AACA,UAAKG,sBAAL,GAA8B,KAA9B;AACA,UAAKC,SAAL,GAAiB,KAAjB;AAEAV,IAAAA,MAAM,CAACW,MAAP,CAAcC,IAAd;AATY;AAUb;;;;WAED,kBAAS;AACP,UAAMC,eAAe,GACnBC,QAAQ,CAACC,aAAT,IACAD,QAAQ,CAACC,aAAT,CAAuBC,OAAvB,KAAmC,OADnC,IAEAF,QAAQ,CAACG,QAAT,EAHF;AAKA,UAAMC,qBAAqB,GACzB,KAAKT,sBAAL,KAAgC,IAAhC,IAAwCI,eAAe,KAAK,KAD9D;;AAGA,UAAIK,qBAAJ,EAA2B;AACzB,aAAKC,oBAAL;AACD,OAFD,MAEO,IAAI,CAACN,eAAL,EAAsB;AAC3B,aAAKO,eAAL;AACD;;AAED,WAAKX,sBAAL,GAA8BI,eAA9B;AACD;;;WAED,2BAAkB;AAChB,UAAI,KAAKH,SAAT,EAAoB;;AAEpB,mCAA0BX,MAAM,CAACI,OAAP,CAAeC,KAAf,EAA1B;AAAA,UAAQC,KAAR,0BAAQA,KAAR;AAAA,UAAeC,MAAf,0BAAeA,MAAf;;AACA,UAAID,KAAK,KAAK,KAAKE,YAAf,IAA+BD,MAAM,KAAK,KAAKE,aAAnD,EAAkE;AAChE,aAAKD,YAAL,GAAoBF,KAApB;AACA,aAAKG,aAAL,GAAqBF,MAArB;AACAN,QAAAA,MAAM,CAACW,MAAP,CAAcC,IAAd;AACD;AACF;;;;0FAED;AAAA;AAAA;AAAA;AAAA;AAAA,qBACM,KAAKF,SADX;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAGE,qBAAKA,SAAL,GAAiB,IAAjB;AAHF;AAAA,uBAIQT,KAAK,CAAC,GAAD,CAJb;;AAAA;AAKE,qBAAKS,SAAL,GAAiB,KAAjB;;AAEA,oBAAIX,MAAM,CAACsB,KAAX,EAAkB;AAChBC,kBAAAA,MAAM,CAACC,MAAP,CAAc,CAAd,EAAiB,CAAjB;AACD;;AAED,qBAAKH,eAAL;;AAXF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;EA1CyBtB,M;;AAyD3B,eAAeI,YAAf","sourcesContent":["import System from '../System'\nimport Device from '../../core/Device'\nimport events from '../../events'\nimport { delay } from '../../time'\n\nclass ResizeSystem extends System {\n  constructor() {\n    super('resize')\n\n    const { width, height } = Device.cssSize.clone()\n    this.$cachedWidth = width\n    this.$cachedHeight = height\n    this.$cachedHasInputFocused = false\n    this.$emitLock = false\n\n    events.resize.emit()\n  }\n\n  update() {\n    const hasInputFocused =\n      document.activeElement &&\n      document.activeElement.tagName === 'INPUT' &&\n      document.hasFocus()\n\n    const isInputSwitchToBlured =\n      this.$cachedHasInputFocused === true && hasInputFocused === false\n\n    if (isInputSwitchToBlured) {\n      this.delayEmitResizeEvent()\n    } else if (!hasInputFocused) {\n      this.emitResizeEvent()\n    }\n\n    this.$cachedHasInputFocused = hasInputFocused\n  }\n\n  emitResizeEvent() {\n    if (this.$emitLock) return\n\n    const { width, height } = Device.cssSize.clone()\n    if (width !== this.$cachedWidth || height !== this.$cachedHeight) {\n      this.$cachedWidth = width\n      this.$cachedHeight = height\n      events.resize.emit()\n    }\n  }\n\n  async delayEmitResizeEvent() {\n    if (this.$emitLock) return\n\n    this.$emitLock = true\n    await delay(250)\n    this.$emitLock = false\n\n    if (Device.isIOS) {\n      window.scroll(0, 0)\n    }\n\n    this.emitResizeEvent()\n  }\n}\n\nexport default ResizeSystem\n"],"file":"index.js"}