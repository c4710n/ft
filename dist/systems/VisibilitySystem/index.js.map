{"version":3,"sources":["../../../src/systems/VisibilitySystem/index.js"],"names":["System","events","VisibilitySystem","listen","show","emit","hide","onShow","onHide","hidden","visibilityChange","document","msHidden","webkitHidden","handleVisibilityChange","isHidden","addEventListener","undefined","console","info"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,MAAP,MAAmB,WAAnB;AACA,OAAOC,MAAP,MAAmB,cAAnB;;IAEMC,gB;;;;;AACJ,8BAAc;AAAA;;AAAA;;AACZ,8BAAM,YAAN;;AAEA,UAAKC,MAAL,CAAYF,MAAM,CAACG,IAAP,CAAYC,IAAxB,EAA8BJ,MAAM,CAACK,IAAP,CAAYD,IAA1C;;AAHY;AAIb;;;;WAED,gBAAOE,MAAP,EAAeC,MAAf,EAAuB;AACrB;AACA,UAAIC,MAAJ,EAAYC,gBAAZ;;AACA,UAAI,OAAOC,QAAQ,CAACF,MAAhB,KAA2B,WAA/B,EAA4C;AAC1C;AACAA,QAAAA,MAAM,GAAG,QAAT;AACAC,QAAAA,gBAAgB,GAAG,kBAAnB;AACD,OAJD,MAIO,IAAI,OAAOC,QAAQ,CAACC,QAAhB,KAA6B,WAAjC,EAA8C;AACnDH,QAAAA,MAAM,GAAG,UAAT;AACAC,QAAAA,gBAAgB,GAAG,oBAAnB;AACD,OAHM,MAGA,IAAI,OAAOC,QAAQ,CAACE,YAAhB,KAAiC,WAArC,EAAkD;AACvDJ,QAAAA,MAAM,GAAG,cAAT;AACAC,QAAAA,gBAAgB,GAAG,wBAAnB;AACD;;AAED,UAAMI,sBAAsB,GAAG,SAAzBA,sBAAyB,GAAM;AACnC,YAAMC,QAAQ,GAAGJ,QAAQ,CAACF,MAAD,CAAzB;;AAEA,YAAIM,QAAJ,EAAc;AACZP,UAAAA,MAAM;AACP,SAFD,MAEO;AACLD,UAAAA,MAAM;AACP;AACF,OARD,CAfqB,CAyBrB;;;AACA,UACE,OAAOI,QAAQ,CAACK,gBAAhB,KAAqC,WAArC,IACAP,MAAM,KAAKQ,SAFb,EAGE;AACA;AACAC,QAAAA,OAAO,CAACC,IAAR,CAAa,0DAAb;AACD,OAND,MAMO;AACL;AACAR,QAAAA,QAAQ,CAACK,gBAAT,CAA0BN,gBAA1B,EAA4CI,sBAA5C,EAAoE,KAApE;AACD;AACF;;;;EA3C4Bd,M;;AA8C/B,eAAeE,gBAAf","sourcesContent":["import System from '../System'\nimport events from '../../events'\n\nclass VisibilitySystem extends System {\n  constructor() {\n    super('visibility')\n\n    this.listen(events.show.emit, events.hide.emit)\n  }\n\n  listen(onShow, onHide) {\n    // Set the name of the hidden property and the change event for visibility\n    let hidden, visibilityChange\n    if (typeof document.hidden !== 'undefined') {\n      // Opera 12.10 and Firefox 18 and later support\n      hidden = 'hidden'\n      visibilityChange = 'visibilitychange'\n    } else if (typeof document.msHidden !== 'undefined') {\n      hidden = 'msHidden'\n      visibilityChange = 'msvisibilitychange'\n    } else if (typeof document.webkitHidden !== 'undefined') {\n      hidden = 'webkitHidden'\n      visibilityChange = 'webkitvisibilitychange'\n    }\n\n    const handleVisibilityChange = () => {\n      const isHidden = document[hidden]\n\n      if (isHidden) {\n        onHide()\n      } else {\n        onShow()\n      }\n    }\n\n    // Warn if the browser doesn't support addEventListener or the Page Visibility API\n    if (\n      typeof document.addEventListener === 'undefined' ||\n      hidden === undefined\n    ) {\n      // eslint-disable-next-line\n      console.info(\"Current browser doesn't support the Page Visibility API.\")\n    } else {\n      // Handle page visibility change\n      document.addEventListener(visibilityChange, handleVisibilityChange, false)\n    }\n  }\n}\n\nexport default VisibilitySystem\n"],"file":"index.js"}